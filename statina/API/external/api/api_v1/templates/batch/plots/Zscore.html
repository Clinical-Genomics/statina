{% block scripts %}
    <script>
        {% for chrom in chromosomes %}
            $(function chrom_plot() {
                var data = []
                var layout = {
                    legend: {hovermode: 'closest'},
                    hovermode: 'closest',
                    annotations: [],
                    xaxis: {
                        showline: true,
                        ticktext: {{ncv_chrom_data[chrom]['names']|tojson}},
                        tickvals: {{ncv_chrom_data[chrom]['x_axis']}},
                        tickangle: 90,
                        linecolor: '#636363',
                        linewidth: 5,
                        showgrid: true,
                        gridcolor: '#bdbdbd'
                    },

                    yaxis: {
                        range: [-10,],
                        zeroline: false,
                        showline: true,
                        showgrid: false,
                        linecolor: '#636363',
                        linewidth: 5,
                        title: 'Zscore{{chrom}}'
                    }
                };

                var cases = {
                    name: "Current batch (N =" + "{{ncv_chrom_data[chrom]['count']}}" + ")",
                    y: {{ncv_chrom_data[chrom]['ncv_values']}},
                    x: {{ncv_chrom_data[chrom]['x_axis']}},
                    text: {{ncv_chrom_data[chrom]['names']|tojson}},
                    mode: 'markers',
                    type: 'scatter',
                };
                data.push(cases)

                var box = {
                    y: {{ normal_data[chrom].ncv_values }},
                    text: {{ normal_data[chrom].names|tojson }},
                    pointpos: 30,
                    type: 'box',
                    marker: {
                        color: '#ccccb3'
                    },
                    name: 'Negative (N={{normal_data[chrom].count}})',
                }
                data.push(box)


                {% for line  in tris_thresholds %}
                    var line = {
                        x: [{{ncv_chrom_data[chrom]['x_axis'][0]}}, {{ncv_chrom_data[chrom]['x_axis'][-1]}}],
                        y: [{{tris_thresholds[line]['Zscore']}}, {{tris_thresholds[line]['Zscore']}}],
                        mode: 'lines',
                        text: "{{tris_thresholds[line]['text']}}",
                        showlegend: false,
                        line: {
                            dash: "dot",
                            color: "{{tris_thresholds[line]["color"]}}",
                            width: 1
                        },
                        name: "{{line}}"
                    };
                    data.push(line);
                {% endfor %}

                {% for status, data  in abnormal_data[chrom].items() %}
                    var verif = {
                        name: "{{status}} T{{chrom}} (N={{data.count}})",
                        y: {{data.ncv_values}},
                        x: {{data.x_axis}},
                        text: {{data.names|tojson}},
                        mode: 'markers',
                        type: 'scatter'
                    };
                    data.push(verif);
                {% endfor %}


                Plotly.newPlot('Zscore{{chrom}}_plot', data, layout);
            });
        {% endfor %}
    </script>


    <script>
        $(document).ready(function () {
            var table = $('#batch_table').DataTable({
                lengthChange: false,
                paging: false,
                info: false,
                searching: false
            });
        });
    </script>



{% endblock %}