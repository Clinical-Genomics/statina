{% extends 'layout/layout.html' %}

{% block body %}
<div class="container-fluid">
    {% include 'sample/header.html' %}
    <ul class="nav nav-tabs" id="myTab">
        <li><a href="{{url_for('sample', sample_id = sample.sample_id)}}">Status table</a>
        </li>
        <li class="active"><a href="{{url_for('sample_tris', sample_id = sample.sample_id)}}">131821-Plot</a>
        </li>
    </ul>
    <div class="tab-pane fade in active" id='131821'>
        <div class="panel panel-default">
            <div class="panel-body">
                <div id="plot_131821" style="min-width:400px; height:700px; "></div><br><br>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>  
    var layout = {
        title: "Sample: {{sample.sample_id}}",
        legend:{hovermode:'closest' },
        hovermode:'closest',
        annotations : [],
        xaxis :{showline: true,
            tickvals : [1,2,3],
            ticktext : ['NCV13','NCV18','NCV21'],
            linecolor: '#636363',
            linewidth: 5,
            showgrid: true,
            gridcolor: '#bdbdbd',
            },
        
        yaxis :{zeroline: false,
            showline: true,
            showgrid: false,
            linecolor: '#636363',
            linewidth: 5,
            title : 'NCV'
            },
        };

    var data = []

    {% for status, data  in abnormal_data.items() %}
        var abnormal = {                                                                  
            name: "{{status}}",                                                               
            y: {{data.ncv_values}},
            x: {{data.x_axis}},
            text: {{data.names|tojson}},
            mode: 'markers',
            marker: {symbol :"circle-open",
                line: {width:2}, 
                color : "{{status_colors[status]}}",
                size: 7} ,                                                  
            type: 'scatter',                                                            
            };    
        data.push(abnormal)
    {% endfor %}


    var sample_data = {
            name: "{{sample.sample_id}}",
            y: {{sample_data.ncv_values}},
            x: {{sample_data.x_axis}},
            mode: 'markers',
            type: 'scatter',
            marker: {size: 11}
            };
        data.push(sample_data)

    {% for chrom, data  in normal_data.items() %}

        var normal = {
            y: {{data.ncv_values}},
            x: {{data.x_axis}},
            pointpos: 30,
            type: 'box',
            showlegend: true,
            marker: {
                color: '#ccccb3'},
                name: 'Negative T{{chrom}} (N={{data.count}})',
                hoverinfo:'none',
                boxpoints: 'suspectedoutliers',
            };
                    

                
                
        data.push(normal); 
    {% endfor %}

    Plotly.newPlot('plot_131821' ,data,  layout);
</script>
                
                
{% endblock %}