{% extends 'layout/layout.html' %}
{% include 'layout/navigation.html' %}

{% block body %}
    <div class="container-fluid">
        <div class="jumbotron vertical-center">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header"><strong>NIPT Samples</strong></h1>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-default">
                    <div id="batch_list">
                        <div class="panel-body">
                         <div class="table-responsive">
                            <table id="sample_table" class="table table-bordered table-hover" >
                                    <thead>
                                        <tr>
                                            <th>Sample Name</th>
                                            <th>Batch ID</th>
                                            <th>Zscore 13</th>
                                            <th>Zscore 18</th>
                                            <th>Zscore 21</th>
                                            <th>Zscore X</th>
                                            <th>FF-PF (%)</th>
                                            <th>FF-X (%)</th>
                                            <th>FF-Y (%)</th>
                                            <th>Sex</th>
                                            <th>CNVSegment</th>
                                            <th><a href="#" data-toggle="tooltip" data-placement="bottom" title="Warning for chomosome abnormality. Automatically generated. Based on pre defined Zscore and Fetal Fraction trsholds">Warning</a></th>
                                            <th>QC Flagg</th>
                                            <th><a href="#" data-toggle="tooltip" data-placement="bottom" title="Chomosome abnormalies. Manually classified by user through the sample page">Status</a></th>
                                            <th>Download</th>
                                            <th><a href="#" data-toggle="tooltip" data-placement="bottom" title="Samples checked in the 'Include' column are added to the validation sample set for comparison. Check the checkboxes for samples to include and save. If all samples are ok, just press 'set all OK'.">Include</a></th>
                                            <th>Comment</th>
                                            <th>Last Change</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for sample in sample_info %}
                                        <tr>
                                            <td width="10%"> <a href={{ url_for('sample', sample_id=sample.sample_id) }}>{{ sample.sample_id }}</a></td>
                                            <td width="10%"> <a href={{ url_for('batch', batch_id=sample.batch_id) }}>{{ sample.batch_id }}</a></td>
                                            <td width="3%" class = "{{ sample.warnings.Zscore_13}}">{{ sample.Zscore_13 }}</td>
                                            <td width="3%" class = "{{ sample.warnings.Zscore_18}}">{{ sample.Zscore_18 }}</td>
                                            <td width="3%" class = "{{ sample.warnings.Zscore_21}}">{{ sample.Zscore_21 }}</td>
                                            <td width="3%" class = "{{ sample.warnings.Zscore_X}}">{{ sample.Zscore_X }}</td>
                                            <td width="3%" class = "{{sample.warnings.FF_Formatted}}">{{sample.FF_Formatted}}</td>
                                            <td width="3%" class = "default">{{sample.FFX}}</td>
                                            <td width="3%" class =  "{{sample.warnings.FFY}}">{{sample.FFY}}</td>
                                            <td width="3%" class = "default">{{sample.sex}}</td>
                                            <td width="3%" class = "default">{{sample.CNVSegment}}</td>
                                            <td width="3%"><p> <small>{{ sample.text_warning }}</small></p></td>
                                            <td width="3%" class = "default">{{sample.QCFlag}}</td>
                                            <td><p> <small>{{ sample.status }}</small></p></td>
                                            <td><a class="dropdown-item" href="{{ url_for('sample_download', file_id='segmental_calls', sample_id=sample.sample_id) }}">segmental calls</a></td>
                                            <td width="1%" {% if sample.include %}class="success"{% endif %}>{{sample.include }}</td>
                                            <td width="18%">{{sample.comment}}</td>
                                            <td ><small>{{sample.change_include_date}}</small></td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        $(document).ready(function () {
            var table = $('#sample_table').DataTable({
                order: [[1, "dec"]],
                paging: true
            });

            table.buttons().container()
                .appendTo('#sample_table_wrapper .col-sm-6:eq(0)');
        });
    </script>
{% endblock %}

